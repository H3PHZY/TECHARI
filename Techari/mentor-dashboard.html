<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mentor Dashboard | Techari</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="icon" type="image/png" href="assets/favicon.png">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: #f8f9fa;
      color: #333;
      line-height: 1.6;
    }

    /* Header */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 2rem;
      background: white;
      border-bottom: 1px solid #e9ecef;
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .logo-link {
      display: flex;
      align-items: center;
      text-decoration: none;
      color: inherit;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .logo {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, #8B5CF6, #A855F7);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
    }

    .brand-name {
      font-size: 1.5rem;
      font-weight: 600;
      color: #333;
      margin-left: 0.5rem;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .mentor-info {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .avatar {
      width: 40px;
      height: 40px;
      background: linear-gradient(135deg, #8B5CF6, #A855F7);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
    }

    .mentor-details h3 {
      font-size: 0.9rem;
      font-weight: 600;
      color: #333;
    }

    .mentor-details p {
      font-size: 0.8rem;
      color: #666;
    }

    .logout-btn {
      background: #dc3545;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.8rem;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .logout-btn:hover {
      background: #c82333;
      transform: translateY(-2px);
    }

    /* Loading states */
    .loading-skeleton {
      background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
      background-size: 200% 100%;
      animation: loading 1.5s infinite;
      border-radius: 4px;
    }

    @keyframes loading {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    .skeleton-name {
      height: 18px;
      width: 120px;
      margin-bottom: 4px;
    }

    .skeleton-role {
      height: 14px;
      width: 60px;
    }

    /* Navigation */
    .nav-bar {
      display: flex;
      gap: 0;
      background: white;
      border-bottom: 1px solid #e9ecef;
      padding: 0 2rem;
    }

    .nav-tab {
      padding: 1rem 1.5rem;
      background: none;
      border: none;
      color: #666;
      font-size: 0.9rem;
      font-weight: 500;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      transition: all 0.3s ease;
    }

    .nav-tab.active {
      color: #667eea;
      border-bottom-color: #667eea;
    }

    .nav-tab:hover:not(.active) {
      color: #333;
    }

    /* Main Dashboard */
    .dashboard {
      padding: 2rem;
      max-width: 1200px;
      margin: 0 auto;
    }

    .welcome-section {
      margin-bottom: 2rem;
    }

    .welcome-section h2 {
      font-size: 2rem;
      font-weight: 600;
      color: #333;
      margin-bottom: 0.5rem;
    }

    .welcome-section p {
      color: #666;
      font-size: 1rem;
    }

    /* Stats Grid */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 3rem;
    }

    .stat-card {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      border: 1px solid #e9ecef;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .stat-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 30px rgba(0,0,0,0.1);
    }

    .stat-title {
      font-size: 0.9rem;
      color: #666;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }

    .stat-value {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0;
    }

    .stat-card:nth-child(1) .stat-value { color: #8B5CF6; }
    .stat-card:nth-child(2) .stat-value { color: #8B5CF6; }
    .stat-card:nth-child(3) .stat-value { color: #8B5CF6; }
    .stat-card:nth-child(4) .stat-value { color: #8B5CF6; }

    /* Quick Actions */
    .quick-actions {
      margin-bottom: 3rem;
    }

    .section-title {
      font-size: 1.3rem;
      font-weight: 600;
      color: #333;
      margin-bottom: 1.5rem;
    }

    .actions-grid {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .action-btn {
      padding: 0.75rem 1.5rem;
      background: linear-gradient(135deg, #8B5CF6, #A855F7);
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
    }

    .action-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.3);
    }

    /* Mentorship Tip */
    .tip-section {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      border-left: 4px solid #f093fb;
      border: 1px solid #e9ecef;
      margin-bottom: 2rem;
    }

    .tip-section h3 {
      color: #333;
      margin-bottom: 1rem;
      font-size: 1.2rem;
      font-weight: 600;
    }

    .tip-section p {
      color: #666;
      line-height: 1.6;
    }

    /* Content Sections */
    .content-section {
      display: none;
    }

    .content-section.active {
      display: block;
    }

    /* Requests Section */
    .requests-list {
      display: grid;
      gap: 1rem;
    }

    .request-card {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      border: 1px solid #e9ecef;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: all 0.3s ease;
    }

    .request-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
    }

    .request-info h4 {
      font-weight: 600;
      color: #333;
      margin-bottom: 0.25rem;
    }

    .request-info p {
      color: #666;
      font-size: 0.9rem;
    }

    .request-actions {
      display: flex;
      gap: 0.5rem;
    }

    .btn-accept {
      background: #28a745;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.8rem;
      transition: all 0.3s ease;
    }

    .btn-accept:hover {
      background: #218838;
      transform: translateY(-2px);
    }

    .btn-decline {
      background: #dc3545;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.8rem;
      transition: all 0.3s ease;
    }

    .btn-decline:hover {
      background: #c82333;
      transform: translateY(-2px);
    }

    /* Sessions Section */
    .sessions-list {
      display: grid;
      gap: 1rem;
    }

    .session-card {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      border: 1px solid #e9ecef;
      transition: all 0.3s ease;
    }

    .session-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
    }

    .session-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .session-date {
      background: #667eea;
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
    }

    /* Availability Section */
    .availability-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }

    .day-card {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      border: 1px solid #e9ecef;
      text-align: center;
      transition: all 0.3s ease;
    }

    .day-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.1);
    }

    .day-name {
      font-weight: 600;
      color: #333;
      margin-bottom: 1rem;
    }

    .time-slot {
      background: #f8f9fa;
      padding: 0.5rem;
      border-radius: 6px;
      margin: 0.5rem 0;
      font-size: 0.9rem;
      color: #666;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .time-slot:hover {
      transform: scale(1.02);
    }

    .time-slot.available {
      background: #d4edda;
      color: #155724;
    }

    /* Notification Toast */
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #28a745;
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      font-size: 0.9rem;
      z-index: 1000;
      transform: translateX(400px);
      transition: all 0.3s ease;
    }

    .toast.show {
      transform: translateX(0);
    }

    .toast.error {
      background: #dc3545;
    }

    /* Loading overlay */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255,255,255,0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      display: none;
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #8B5CF6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Responsive */
    @media (max-width: 768px) {
      .header {
        padding: 1rem;
      }

      .nav-bar {
        padding: 0 1rem;
        overflow-x: auto;
      }

      .dashboard {
        padding: 1rem;
      }

      .stats-grid {
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      }

      .actions-grid {
        flex-direction: column;
      }

      .action-btn {
        width: 100%;
      }

      .request-card {
        flex-direction: column;
        gap: 1rem;
        align-items: flex-start;
      }

      .request-actions {
        width: 100%;
        justify-content: flex-end;
      }

      .session-header {
        flex-direction: column;
        gap: 0.5rem;
        align-items: flex-start;
      }

      .availability-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 480px) {
      .header-right {
        gap: 0.5rem;
      }

      .mentor-details {
        display: none;
      }

      .brand-name {
        font-size: 1.2rem;
      }

      .welcome-section h2 {
        font-size: 1.5rem;
      }

      .stat-card {
        padding: 1.5rem;
      }

      .stat-value {
        font-size: 2rem;
      }
    }
  </style>
</head>
<body>
  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="spinner"></div>
  </div>

  <header class="header">
    <div class="header-left">
      <a href="about.html" class="logo-link">
        <div class="logo">T</div>
        <h1 class="brand-name">Techari</h1>
      </a>
    </div>
    <div class="header-right">
      <div class="mentor-info">
        <div class="avatar" id="mentorAvatar">
          <div class="loading-skeleton skeleton-name"></div>
        </div>
        <div class="mentor-details">
          <h3 id="mentorName">
            <div class="loading-skeleton skeleton-name"></div>
          </h3>
          <p id="mentorRole">
            <div class="loading-skeleton skeleton-role"></div>
          </p>
        </div>
      </div>
      <button class="logout-btn" onclick="handleLogout()">Logout</button>
    </div>
  </header>

  <nav class="nav-bar">
    <button class="nav-tab active" onclick="showSection('overview')">Overview</button>
    <button class="nav-tab" onclick="showSection('requests')">Requests</button>
    <button class="nav-tab" onclick="showSection('sessions')">My Sessions</button>
    <button class="nav-tab" onclick="showSection('availability')">Availability</button>
  </nav>

  <main class="dashboard">
    <!-- Overview Section -->
    <div class="content-section active" id="overview">
      <div class="welcome-section">
        <h2 id="welcomeMessage">Welcome back! ðŸ‘‹</h2>
        <p>Manage your mentorship sessions and availability</p>
      </div>

      <div class="stats-grid">
        <div class="stat-card" onclick="showSection('requests')">
          <p class="stat-title">Pending Requests</p>
          <p class="stat-value" id="pendingRequestsCount">3</p>
        </div>
        <div class="stat-card" onclick="showSection('sessions')">
          <p class="stat-title">Upcoming Sessions</p>
          <p class="stat-value" id="upcomingSessionsCount">2</p>
        </div>
        <div class="stat-card">
          <p class="stat-title">Active Mentees</p>
          <p class="stat-value" id="activeMenteesCount">5</p>
        </div>
        <div class="stat-card" onclick="showSection('availability')">
          <p class="stat-title">Availability Slots</p>
          <p class="stat-value" id="availabilitySlotsCount">4</p>
        </div>
      </div>

      <div class="quick-actions">
        <h3 class="section-title">Quick Actions</h3>
        <div class="actions-grid">
          <button class="action-btn" onclick="showSection('requests')">View Requests</button>
          <button class="action-btn" onclick="showSection('sessions')">Manage Sessions</button>
          <button class="action-btn" onclick="showSection('availability')">Update Availability</button>
          <button class="action-btn" onclick="showProfile()">Edit Profile</button>
        </div>
      </div>

      <div class="tip-section">
        <h3>Mentorship Tip</h3>
        <p>ðŸ’¡ Stay consistent with your availability. Clear communication and session notes help mentees get the best out of each session.</p>
      </div>
    </div>

    <!-- Requests Section -->
    <div class="content-section" id="requests">
      <div class="welcome-section">
        <h2>Mentorship Requests</h2>
        <p>Review and respond to mentorship requests from aspiring women in tech</p>
      </div>

      <div class="requests-list" id="requestsList">
        <div class="request-card">
          <div class="request-info">
            <h4>Sarah Johnson</h4>
            <p>Frontend Developer â€¢ Interested in React and career transition</p>
            <p><small>Requested: 2 hours ago</small></p>
          </div>
          <div class="request-actions">
            <button class="btn-accept" onclick="acceptRequest('Sarah Johnson', this)">Accept</button>
            <button class="btn-decline" onclick="declineRequest('Sarah Johnson', this)">Decline</button>
          </div>
        </div>

        <div class="request-card">
          <div class="request-info">
            <h4>Maria Rodriguez</h4>
            <p>Data Scientist â€¢ Looking for guidance on machine learning projects</p>
            <p><small>Requested: 5 hours ago</small></p>
          </div>
          <div class="request-actions">
            <button class="btn-accept" onclick="acceptRequest('Maria Rodriguez', this)">Accept</button>
            <button class="btn-decline" onclick="declineRequest('Maria Rodriguez', this)">Decline</button>
          </div>
        </div>

        <div class="request-card">
          <div class="request-info">
            <h4>Fatima Al-Zahra</h4>
            <p>Software Engineering Student â€¢ Seeking advice on tech interview preparation</p>
            <p><small>Requested: 1 day ago</small></p>
          </div>
          <div class="request-actions">
            <button class="btn-accept" onclick="acceptRequest('Fatima Al-Zahra', this)">Accept</button>
            <button class="btn-decline" onclick="declineRequest('Fatima Al-Zahra', this)">Decline</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Sessions Section -->
    <div class="content-section" id="sessions">
      <div class="welcome-section">
        <h2>My Sessions</h2>
        <p>Manage your upcoming and completed mentorship sessions</p>
      </div>

      <div class="sessions-list">
        <div class="session-card">
          <div class="session-header">
            <h4>Session with Jennifer Chen</h4>
            <span class="session-date">Tomorrow, 2:00 PM</span>
          </div>
          <p><strong>Topic:</strong> Career transition from marketing to UX design</p>
          <p><strong>Duration:</strong> 60 minutes</p>
          <p><strong>Platform:</strong> Google Meet</p>
          <button class="action-btn" style="margin-top: 1rem;" onclick="joinSession('Jennifer Chen')">Join Session</button>
        </div>

        <div class="session-card">
          <div class="session-header">
            <h4>Session with Priya Sharma</h4>
            <span class="session-date">Friday, 10:00 AM</span>
          </div>
          <p><strong>Topic:</strong> Building confidence in technical presentations</p>
          <p><strong>Duration:</strong> 45 minutes</p>
          <p><strong>Platform:</strong> Google Meet</p>
          <button class="action-btn" style="margin-top: 1rem;" onclick="joinSession('Priya Sharma')">Join Session</button>
        </div>

        <div class="session-card">
          <div class="session-header">
            <h4>Completed: Session with Lisa Park</h4>
            <span class="session-date">Last Week</span>
          </div>
          <p><strong>Topic:</strong> Negotiating salary and promotions in tech</p>
          <p><strong>Duration:</strong> 50 minutes</p>
          <p><strong>Platform:</strong> Google Meet</p>
          <button class="action-btn" style="margin-top: 1rem; background: #6c757d;" onclick="viewSessionNotes('Lisa Park')">View Notes</button>
        </div>
      </div>
    </div>

    <!-- Availability Section -->
    <div class="content-section" id="availability">
      <div class="welcome-section">
        <h2>My Availability</h2>
        <p>Set your available time slots for mentorship sessions</p>
      </div>

      <div class="availability-grid">
        <div class="day-card">
          <div class="day-name">Monday</div>
          <div class="time-slot available">2:00 PM - 3:00 PM</div>
          <div class="time-slot">4:00 PM - 5:00 PM</div>
          <div class="time-slot">6:00 PM - 7:00 PM</div>
        </div>

        <div class="day-card">
          <div class="day-name">Tuesday</div>
          <div class="time-slot">10:00 AM - 11:00 AM</div>
          <div class="time-slot available">2:00 PM - 3:00 PM</div>
          <div class="time-slot">5:00 PM - 6:00 PM</div>
        </div>

        <div class="day-card">
          <div class="day-name">Wednesday</div>
          <div class="time-slot available">9:00 AM - 10:00 AM</div>
          <div class="time-slot available">3:00 PM - 4:00 PM</div>
          <div class="time-slot">7:00 PM - 8:00 PM</div>
        </div>

        <div class="day-card">
          <div class="day-name">Thursday</div>
          <div class="time-slot">11:00 AM - 12:00 PM</div>
          <div class="time-slot available">2:00 PM - 3:00 PM</div>
          <div class="time-slot">6:00 PM - 7:00 PM</div>
        </div>

        <div class="day-card">
          <div class="day-name">Friday</div>
          <div class="time-slot available">10:00 AM - 11:00 AM</div>
          <div class="time-slot">1:00 PM - 2:00 PM</div>
          <div class="time-slot">4:00 PM - 5:00 PM</div>
        </div>
      </div>

      <div style="margin-top: 2rem; text-align: center;">
        <button class="action-btn" onclick="saveAvailability()">Save Availability</button>
      </div>
    </div>
  </main>

  <!-- Firebase Scripts -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="js/firebase-config.js"></script>

  <script>
    // Initialize Firebase services
    const auth = firebase.auth();
    const db = firebase.firestore();

    let currentUser = null;
    let userProfile = null;

    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
      initializeApp();
      setupUIInteractions();
    });

    // Initialize the application
    function initializeApp() {
      showLoadingOverlay(true);
      
      // Check authentication state
      auth.onAuthStateChanged(async (user) => {
        if (!user) {
          // Redirect to login if not authenticated
          window.location.href = 'index.html';
          return;
        }

        try {
          currentUser = user;
          await loadUserProfile(user);
          await loadMentorData(user.uid);
          showLoadingOverlay(false);
        } catch (error) {
          console.error("Error loading user data:", error);
          showFallbackProfile(user);
          showLoadingOverlay(false);
        }
      });
    }

    // Load user profile from Firestore
    async function loadUserProfile(user) {
      try {
        const userDoc = await db.collection('profiles').doc(user.uid).get();
        
        if (userDoc.exists) {
          userProfile = userDoc.data();
          
          // Check if user is actually a mentor
          if (userProfile.role !== 'mentor') {
            // Redirect to appropriate dashboard
            if (userProfile.role === 'mentee') {
              window.location.href = 'mentee-dashboard.html';
            } else {
              window.location.href = 'profile-setup.html';
            }
            return;
          }
          
          updateUserInterface(userProfile);
        } else {
          // No profile found, use fallback
          showFallbackProfile(user);
        }
      } catch (error) {
        console.error('Error fetching user profile:', error);
        showFallbackProfile(user);
      }
    }

    // Update the user interface with actual user data
    function updateUserInterface(profile) {
      // Update mentor name
      const mentorNameElement = document.getElementById('mentorName');
      const mentorRoleElement = document.getElementById('mentorRole');
      const mentorAvatarElement = document.getElementById('mentorAvatar');
      const welcomeMessageElement = document.getElementById('welcomeMessage');

      // Extract first name for welcome message
      const firstName = profile.name ? profile.name.split(' ')[0] : 'Mentor';
      
      // Get initials for avatar
      const initials = getInitials(profile.name || currentUser.email || 'M');

      // Update elements
      mentorNameElement.textContent = profile.name || currentUser.email || 'Mentor';
      mentorRoleElement.textContent = 'Mentor';
      mentorAvatarElement.textContent = initials;
      welcomeMessageElement.textContent = `Welcome back, ${firstName}! ðŸ‘‹`;

      console.log('UI updated with user profile:', profile);
    }

    // Show fallback profile when Firebase data is not available
    function showFallbackProfile(user) {
      const email = user.email || '';
      const displayName = user.displayName || email.split('@')[0] || 'Mentor';
      const firstName = displayName.split(' ')[0];
      const initials = getInitials(displayName);

      document.getElementById('mentorName').textContent = displayName;
      document.getElementById('mentorRole').textContent = 'Mentor';
      document.getElementById('mentorAvatar').textContent = initials;
      document.getElementById('welcomeMessage').textContent = `Welcome back, ${firstName}! ðŸ‘‹`;

      console.log('Using fallback profile for:', email);
    }

    // Get initials from name
    function getInitials(name) {
      if (!name) return 'M';
      
      const nameParts = name.split(' ');
      if (nameParts.length >= 2) {
        return (nameParts[0][0] + nameParts[1][0]).toUpperCase();
      } else {
        return nameParts[0][0].toUpperCase();
      }
    }

    // Navigation functionality
    function showSection(sectionId) {
      // Hide all sections
      const sections = document.querySelectorAll('.content-section');
      sections.forEach(section => {
        section.classList.remove('active');
      });

      // Remove active class from all nav tabs
      const navTabs = document.querySelectorAll('.nav-tab');
      navTabs.forEach(tab => {
        tab.classList.remove('active');
      });

      // Show selected section
      document.getElementById(sectionId).classList.add('active');
      
      // Add active class to clicked nav tab
      const clickedTab = Array.from(navTabs).find(tab => 
        tab.textContent.toLowerCase().includes(sectionId === 'overview' ? 'overview' : 
        sectionId === 'requests' ? 'requests' : 
        sectionId === 'sessions' ? 'sessions' : 'availability')
      );
      if (clickedTab) {
        clickedTab.classList.add('active');
      }
    }

    // Load mentor-specific data
    async function loadMentorData(userId) {
      try {
        // Load requests, sessions, availability, etc.
        // This is where you'd load actual data from Firestore
        updateDashboardStats(3, 2, 5, 4); // Demo stats
        console.log('Mentor data loaded for:', userId);
      } catch (error) {
        console.error('Error loading mentor data:', error);
        // Use fallback data
        updateDashboardStats(3, 2, 5, 4);
      }
    }

    // Update dashboard statistics
    function updateDashboardStats(pending, upcoming, active, slots) {
      document.getElementById('pendingRequestsCount').textContent = pending;
      document.getElementById('upcomingSessionsCount').textContent = upcoming;
      document.getElementById('activeMenteesCount').textContent = active;
      document.getElementById('availabilitySlotsCount').textContent = slots;
    }

    // Request handling functions
    async function acceptRequest(mentee, buttonElement) {
      try {
        showLoadingOverlay(true);
        
        // Simulate API call
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        showToast(`Mentorship request from ${mentee} has been accepted! A confirmation email will be sent.`, 'success');
        updatePendingRequestsCount(-1);
        
        // Remove the request card from UI
        const requestCard = buttonElement.closest('.request-card');
        requestCard.style.opacity = '0.5';
        requestCard.style.pointerEvents = 'none';
        setTimeout(() => requestCard.remove(), 500);
        
        showLoadingOverlay(false);
      } catch (error) {
        console.error('Error accepting request:', error);
        showToast('Error accepting request. Please try again.', 'error');
        showLoadingOverlay(false);
      }
    }

    async function declineRequest(mentee, buttonElement) {
      if (!confirm(`Are you sure you want to decline the mentorship request from ${mentee}?`)) {
        return;
      }
      
      try {
        showLoadingOverlay(true);
        
        // Simulate API call
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        showToast(`Mentorship request from ${mentee} has been declined.`, 'success');
        updatePendingRequestsCount(-1);
        
        // Remove the request card from UI
        const requestCard = buttonElement.closest('.request-card');
        requestCard.style.opacity = '0.5';
        requestCard.style.pointerEvents = 'none';
        setTimeout(() => requestCard.remove(), 500);
        
        showLoadingOverlay(false);
      } catch (error) {
        console.error('Error declining request:', error);
        showToast('Error declining request. Please try again.', 'error');
        showLoadingOverlay(false);
      }
    }

    function updatePendingRequestsCount(change) {
      const pendingElement = document.getElementById('pendingRequestsCount');
      const currentCount = parseInt(pendingElement.textContent);
      pendingElement.textContent = Math.max(0, currentCount + change);
    }

    // Session management functions
    function joinSession(mentee) {
      showToast(`Joining session with ${mentee}...`, 'success');
      // In a real app, this would open the video call platform
      setTimeout(() => {
        window.open('https://meet.google.com/new', '_blank');
      }, 1000);
    }

    function viewSessionNotes(mentee) {
      showToast(`Opening session notes for ${mentee}...`, 'success');
      // In a real app, this would show session notes
    }

    // Availability management
    function saveAvailability() {
      const availableSlots = document.querySelectorAll('.time-slot.available');
      showLoadingOverlay(true);
      
      // Simulate saving to database
      setTimeout(() => {
        showToast(`Availability updated! ${availableSlots.length} slots are now available.`, 'success');
        document.getElementById('availabilitySlotsCount').textContent = availableSlots.length;
        showLoadingOverlay(false);
      }, 1000);
    }

    // Profile management
    function showProfile() {
      showToast('Redirecting to profile editor...', 'success');
      setTimeout(() => {
        window.location.href = 'profile-setup.html';
      }, 1000);
    }

    // Logout functionality
    async function handleLogout() {
      if (!confirm('Are you sure you want to logout?')) {
        return;
      }
      
      try {
        showLoadingOverlay(true);
        await auth.signOut();
        showToast('Logged out successfully!', 'success');
        setTimeout(() => {
          window.location.href = 'index.html';
        }, 1000);
      } catch (error) {
        console.error('Error logging out:', error);
        showToast('Error logging out. Please try again.', 'error');
        showLoadingOverlay(false);
      }
    }

    // Setup UI interactions
    function setupUIInteractions() {
      // Add click handlers for time slots in availability section
      const timeSlots = document.querySelectorAll('.time-slot');
      timeSlots.forEach(slot => {
        slot.addEventListener('click', function() {
          this.classList.toggle('available');
          if (this.classList.contains('available')) {
            this.style.background = '#d4edda';
            this.style.color = '#155724';
          } else {
            this.style.background = '#f8f9fa';
            this.style.color = '#666';
          }
        });
      });

      // Add hover effects for cards
      const cards = document.querySelectorAll('.stat-card, .request-card, .session-card, .day-card');
      cards.forEach(card => {
        card.addEventListener('mouseenter', function() {
          if (!this.classList.contains('stat-card')) {
            this.style.transform = 'translateY(-4px)';
            this.style.boxShadow = '0 8px 30px rgba(0,0,0,0.1)';
          }
        });
        
        card.addEventListener('mouseleave', function() {
          if (!this.classList.contains('stat-card')) {
            this.style.transform = 'translateY(0)';
            this.style.boxShadow = '0 1px 3px rgba(0,0,0,0.1)';
          }
        });
      });

      // Add keyboard navigation support
      document.addEventListener('keydown', function(e) {
        if (e.ctrlKey || e.metaKey) {
          switch(e.key) {
            case '1':
              e.preventDefault();
              showSection('overview');
              break;
            case '2':
              e.preventDefault();
              showSection('requests');
              break;
            case '3':
              e.preventDefault();
              showSection('sessions');
              break;
            case '4':
              e.preventDefault();
              showSection('availability');
              break;
          }
        }
      });

      // Add smooth scrolling for navigation
      const navTabs = document.querySelectorAll('.nav-tab');
      navTabs.forEach(tab => {
        tab.addEventListener('click', function() {
          document.querySelector('.dashboard').scrollIntoView({ 
            behavior: 'smooth',
            block: 'start'
          });
        });
      });
    }

    // Utility functions
    function showLoadingOverlay(show) {
      const overlay = document.getElementById('loadingOverlay');
      overlay.style.display = show ? 'flex' : 'none';
    }

    function showToast(message, type = 'success') {
      // Remove existing toasts
      const existingToasts = document.querySelectorAll('.toast');
      existingToasts.forEach(toast => toast.remove());

      // Create new toast
      const toast = document.createElement('div');
      toast.className = `toast ${type === 'error' ? 'error' : ''}`;
      toast.textContent = message;
      document.body.appendChild(toast);

      // Show toast
      setTimeout(() => {
        toast.classList.add('show');
      }, 100);

      // Hide toast after 3 seconds
      setTimeout(() => {
        toast.classList.remove('show');
        setTimeout(() => {
          toast.remove();
        }, 300);
      }, 3000);
    }

    // Error handling
    window.addEventListener('error', function(e) {
      console.error('Global error:', e.error);
      showToast('An unexpected error occurred. Please refresh the page.', 'error');
    });

    // Handle network connectivity
    window.addEventListener('online', function() {
      showToast('Connection restored!', 'success');
    });

    window.addEventListener('offline', function() {
      showToast('Connection lost. Some features may not work properly.', 'error');
    });
  </script>
</body>
</html>